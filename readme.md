# Тестовое задание "Создание REST API приложения" для компании Secunda


### Описание.

Дано вот такое описание задачи:
```
Описание.
Необходимо реализовать REST API приложения для справочника Организаций, Зданий, Деятельности.
1.Организация - Представляет собой карточку организации в справочнике и должна содержать в себе следующую информацию:
	- Название: Например ООО “Рога и Копыта”
    - Номер телефона: организация может иметь несколько номеров телефонов (2-222-222, 3-333-333, 8-923-666-13-13)
    - Здание: Организация должна находится в одном конкретном здании (Например, Блюхера, 32/1)
    - Деятельность: Организация может заниматься несколькими видами деятельностей (Например, “Молочная продукция”, “Мясная продукция”)
2.Здание - Содержит в себе как минимум информацию о конкретном здании, а именно:
	- Адрес: Например - г. Москва, ул. Ленина 1, офис 3
	- Географические координаты: Местоположение здания должно быть в виде широты и долготы.
3.Деятельность - позволяет классифицировать род деятельности организаций в каталоге. Имеет название и может в древовидном виде вкладываться друг в друга. Пример возможного дерева деятельности:
  - Еда
    - Мясная продукция
    - Молочная продукция
  - Автомобили
    - Грузовые
    - Легковые
      - Запчасти
      - Аксессуары
4. Стэк - стэк fastapi+pydantic+sqlalchemy+alembic

Функционал приложения.

Взаимодействие с пользователем происходит посредством HTTP запросов к API серверу с использованием статического API ключа. Все ответы должны быть в формате JSON. Необходимо реализовать следующие методы:
·	список всех организаций находящихся в конкретном здании
·	список всех организаций, которые относятся к указанному виду деятельности
·	список организаций, которые находятся в заданном радиусе/прямоугольной области относительно указанной точки на карте. список зданий
·	вывод информации об организации по её идентификатору
·	искать организации по виду деятельности. Например, поиск по виду деятельности «Еда», которая находится на первом уровне дерева, и чтобы нашлись все организации, которые относятся к видам деятельности, лежащим внутри. Т.е. в результатах поиска должны отобразиться организации с видом деятельности Еда, Мясная продукция, Молочная продукция.
·	поиск организации по названию
    ·	ограничить уровень вложенности деятельностей 3 уровням

Задание
·	Спроектировать БД + Создать необходимые миграции + Заполнить БД тестовыми данными
·	Реализовать API согласно разделу Функционал приложения
·	Завернуть приложения в Docker контейнер, чтобы его можно было развернуть на любой машине (Если необходимо, то написать инструкцию по разворачиванию)
·	Добавить в проект документацию Swagger UI или Redoc с описанием всех методов приложения.
```

Вроде бы описание выглядит более чем понятным.
Классическое описание бизнес задачи, с уровня бизнес задачи - до уровня таски разработчику. С точки зрения прочтения только раздела "Описание", то задачи бизнеса вполне понятны:
Необходим микросервис, для обработки данных в БД и обратно. 

Однако в 4 пункте указан четкий стэк: `fastapi+pydantic+sqlalchemy+alembic`. На первый взгляд все предельно ясно.
- Зачем добавлен pydantic, если есть fastapi - Непонятно.`+3 часа к разработке - Гуглил может fastapi принимать не pydantic и как. Сами решайте - это стимулирование развития разработчика или низкая производительность труда.`

Так же указан alembic, а значит банального CRUD недостаточно. Необходим механизм репликации. 
- Однако, ничего про отказоустойчивость приложения в бизнес части не сказано. `+1 день к разработке. Пришлось писать шаблны. ППЦ пацаны заебывает. Может кто нибудь создаст опен сорус?`

Далее смотря в пункт "Функционал приложения", мы понимаем - Это задачи уже сформулированные системным аналитиком для команды. Несмотря на какие-нибудь модные АГИЛЕ, все эти задачи читает тим лид. 
- Как говорит мой отец - "Если позвали системного аналитика в команду, то явно разработчики не понимают что они делают".`+2 дня к разработке, пытался вникнуть в саму суть задач, ппц пацаны, иначе бы это все не писал.`

Необходимо сделать 6 ручек с отдачей данных из БД. И тут есть несколько альтернативных трактований с точки зрения реализации.
- Ограничение в последнем пункте вложенности определено от балды: Он не прописан на уровне Бизнес-задачи. `+1 день к разработке. Вложеность - значит логика таблиц. И Тут надо уже будет подмуть над решением`.
    - решение: выбор крайне сложен из-за организации вложености либо на уровне разных таблиц, или из-за еще одного столбца в общей таблице вложенности. Первое решение - Кажется проще, и по первому прочтению именно к нему принуждает. Добавление же еще одного столбца, усложняет таблицу, но зато ради одной ручки не надо громоздить таблицы. и уровень вложености можно повторять бесконечно.

- Если рассмотреть все ручки, то это обычные GET запросы. Если рассматривать это как микросервис - то тут есть архитектурный изъян. Нет никаких методов записи в БД у микросервиса. Поскольку только он должен работать с этой БД. `+1 день работы. И зачем тут тогда репликация? если не должен?`
  - Упоминание бы этого пункта конкретно сократило время для разработки. Поскольку бы помогло бы сделать таблицы быстрее или сразу.

- Непонятно, нужно ли упомянуть, что это за здание и его координаты `+1 день разратки`
- Вид деятельности нудно как возвращать - только для определенных указанных или включая вложенность ? `+2 дня разратки` 
    - Ответ на этот вопрос критически влияет с багом: Если у нас пропадает ссылка на уровне графа зависимостей, то у нас могут скапливаться данные при такой операции. 

- А если у здания нет координат? `+1 день разратки`
- Идентификатор организации внутренний или внешний ? А какую именно информацию отдавать по адресу или уровню вложенности организаций ?  `+3 день разратки`
- Не является последний роут повторением что указан второным ? или это поиск по %LIKE ? `+2 дня разратки`

Задание
1. Проектирование БД и ее заполнение. Поэтому необходимо спроектировать связи.
2. Создание роуты ручек

Работа с БД
  - Необходимо разработать связи между таблицами - В здании могут быть несколько организаций, а хранить вместе адрес здания и его координаты - не целесообразно. Так же деятельность компании может быть смежными.
  - Решить проблему вложенности деятельности. Можно ли присвоить деятельность для 1 и 2 уровня вложенности.
  - Являются ли уровни вложенности деятельности компаний уже определенным.

